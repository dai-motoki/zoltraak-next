--- original
+++ modified
@@ -63,6 +63,7 @@
 import subprocess
 import os
 import datetime
+import sys
 
 # ログの設定
 logging.basicConfig(level=logging.WARNING, format='%(asctime)s - %(levelname)s - %(message)s')
@@ -166,6 +167,7 @@
     指定されたファイルに対して要望に基づいた変更を行います。
 
     :param file_name: 変更対象のファイル名
+    :param save_diff: Diffをファイルに保存するかどうかのフラグ
     :param request: 変更の要望
     :return: 変更後のファイルの内容
     """
@@ -195,12 +197,13 @@
             print(f"パッチの適用中にエラーが発生しました: {str(e)}")
             return None
 
-        # Diffを時間付きで保存
-        timestamp = datetime.datetime.now().strftime("%Y%m%d_%H%M%S")
-        diff_file_name = f"{file_name}_{timestamp}.diff"
-        with open(diff_file_name, 'w', encoding='utf-8') as diff_file:
-            diff_file.write(diff_result)
-
+        # Diffの保存をフラグで制御
+        if save_diff:
+            timestamp = datetime.datetime.now().strftime("%Y%m%d_%H%M%S")
+            diff_file_name = f"{file_name}_{timestamp}.diff"
+            with open(diff_file_name, 'w', encoding='utf-8') as diff_file:
+                diff_file.write(diff_result)
+            print(f"Diffが{diff_file_name}に保存されました。")
         print(f"Diffが{diff_file_name}に保存されました。")
 
         # 変更後の内容をファイルに書き込む
@@ -219,18 +222,20 @@
     parser.add_argument("-f", "--file", required=True, help="変更対象のファイル名")
     parser.add_argument("-r", "--request", help="変更の要望")
     parser.add_argument("-rf", "--request-file", help="要望が記載されたファイル")
+    parser.add_argument("-sd", "--save-diff", action="store_true", help="Diffをファイルに保存するかどうか")
     
     args = parser.parse_args()
 
     if args.request:
-        diffp(args.file, args.request)
+        diffp(args.file, args.request, args.save_diff)
     elif args.request_file:
         with open(args.request_file, 'r', encoding='utf-8') as rf:
             request = rf.read()
-        diffp(args.file, request)
+        diffp(args.file, request, args.save_diff)
     else:
         print("エラー: 変更の要望（-r）または要望ファイル（-rf）のいずれかを指定してください。")
         parser.print_help()
         sys.exit(1)
 
-# 以下のコメントは、変更内容の説明です：
+# 変更内容の説明：
+# 1. diffp関数にsave_diff引数を追加し、Diffの保存をフラグで制御するようにしました。